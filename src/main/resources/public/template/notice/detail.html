<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="_csrf" th:content="${_csrf.token}"/>
<link rel="stylesheet" th:href="@{/assets/vendors/bootstrap-4.3.1-dist/css/bootstrap.min.css}" />
<script src="../../assets/vendors/jquery-3.4.0/jquery-3.4.0.min.js"></script>
<script src="../../assets/js/withoutJquery.js"></script>
<title>Insert title here</title>
</head>
<body>
	<div class="container">
		<br /> 	
		<form id = "frm" method = "post">
		<table class="table" border="1">
			<tr>
				<th>제목</th>
				<td colspan="3"><span th:text="${notice?.noticeTitle}"></span></td>
			</tr>
			<tr>
				<th>내용</th>
				<td colspan="3" style="text-align:center;"><textarea maxlength="140" rows="10" style="width:750px; resize:none;" th:text="${notice?.noticeContents}" readonly = "readonly"></textarea></td>
			</tr>
			<tr>
				<th>작성자</th>
				<td colspan="3"><span th:text="${notice?.createUserid}"/></span></td>
			</tr>
			<tr style = "display:none;">
				<th>팝업 알림 설정</th>
				<td>
					<div>
						<label><input type="radio" id = "pop_radio_bt_up" name="popYn" th:value="${notice.popYn}" onclick ="return(false);">설정</label>
						<label><input type="radio" id = "pop_radio_bt_down" name="popYn" th:value="${notice.popYn}" onclick ="return(false);">미설정</label>
					</div>
				</td>
				<th>상단 공지 설정</th>
				<td>
					<div>
						<label><input type="radio" id = "top_radio_bt_up" name="topNoticeYn" th:value="${notice.topNoticeYn}" onclick ="return(false);">설정</label>
						<label><input type="radio" id = "top_radio_bt_down" name="topNoticeYn" th:value="${notice.topNoticeYn}" onclick ="return(false);">미설정</label>
					</div>
				</td>
			</tr>
		</table>
		<div id="pop_tab" style = "display:none;">
			<table class="table" border="1">
				<tr>
					<th rowspan="4">팝업 알림 설정 정보</th>
					<th>*높이</th>
					<td colspan="2"><span th:text="${notice?.popHeight}"></span></td>
				</tr>
				<tr>
					<th>*넓이</th>
					<td colspan="2"><span th:text="${notice?.popWidth}"/></span></td>
				</tr>
				<tr>
					<th>*시작일</th>
					<td colspan="2"><span th:text="${#temporals.format(notice.popStrtDt,'yyyy-MM-dd HH:mm:ss')}" ></span></td>
				</tr>
				<tr>
					<th>*종료일</th>
					<td colspan="2"><span th:text="${#temporals.format(notice.popEndDt,'yyyy-MM-dd HH:mm:ss')}"/></span></td>
				</tr>
			</table>
		</div>

		<div id="top_notice_tab" style = "display:none;">
			<table class="table" border="1">
				<tr>
					<th rowspan="4">상단 공지 설정 정보</th>
					<th>*시작일</th>
					<td colspan="2"><span th:text="${#temporals.format(notice.topNoticeStrtDt,'yyyy-MM-dd HH:mm:ss')}"></span></td>
				</tr>
				<tr>
					<th>*종료일</th>
					<td colspan="2"><span th:text="${#temporals.format(notice.topNoticeEndDt,'yyyy-MM-dd HH:mm:ss')}"></span></td>
				</tr>
			</table>
		</div>
		<div style = "float:right;">
			<button type="button" onclick="location.href='/notices/list'">목록</button>
            <button th:if="${notice?.noticeNo}" type="button" th:onclick ="'location.href =\'' + @{/notices/form?id={noticeNo}(noticeNo = ${notice.NoticeNo})}+'\''">수정</button>
			<button th:if="${notice?.noticeNo}" type="button" id="delete" th:onclick="restSubmit('POST',[[@{/notices/{noticeNo}(noticeNo=${notice.noticeNo})}]])">삭제</button>
		</div>
		</form>
	</div>
	
	<script th:inline="javascript">
	/*<![CDATA[ */	
		window.onload = function() {

		// 게시물 삭제 처리 시, validation 체크.
		var noticeNo = /*[[${notice.noticeNo}]]*/;
		if(noticeNo == null){
			if(noticeNo == null){alert("이미 삭제된 게시물 입니다."); return history.go(-1)};
		}

		if(document.getElementsByName('popYn')[0].value == 'true') {
			document.getElementById('pop_radio_bt_up').checked = true;
			/* document.getElementById('pop_tab').style.display = ''; */
		} else {
			document.getElementById('pop_radio_bt_down').checked = true;
			document.getElementById('pop_tab').style.display = 'none';
		}
		
		if(document.getElementsByName('topNoticeYn')[0].value == 'true') {
			document.getElementById('top_radio_bt_up').checked = true;
			/* document.getElementById('top_notice_tab').style.display = ''; */
		} else {
		    document.getElementById('top_radio_bt_down').checked = true;
			document.getElementById('top_notice_tab').style.display = 'none';
		}
	}
	
	//RESTFUL API
	function restSubmit(method, url, async) {
		var xmlhttp = createXmlHttpRequestObject(method, url, async);
		xmlhttp.onreadystatechange = function() {
			if (xmlhttp.readyState == XMLHttpRequest.DONE) {   // XMLHttpRequest.DONE == 4
				if (xmlhttp.status == 200) {
					alert("삭제 처리되었습니다.");
					window.location = "/notices/list";
                } else if (xmlhttp.status == 400) {
                	alert('There was an error 400');
                } else {
                	alert('something else other than 200 was returned');
                }
			}	
    	};
    	xmlhttp.send(null);	
	}
	/* ]]> */
	</script>
</body>
</html>