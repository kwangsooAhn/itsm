<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Insert title here</title>
</head>
<body>
    <nav class="navbar navbar-expand-lg bg-primary alice-navbar">
        <a class="navbar-brand" href="#">
            <img th:src="@{/assets/media/icons/logo.png}" width="40" height="40" alt="Alice">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul id="main-menu" class="mr-auto">
                <li th:each="topMenu : ${#authentication.details.menus}"
                    th:order-data="${topMenu.sort}" th:if="${topMenu.pMenuId} == 'menu'">
                    <a class="nav-link" th:text="#{|menu.${topMenu.menuId}|}"></a>
                    <ul class="sub-menu">
                        <li th:each="subMenu : ${#authentication.details.menus}"
                            th:order-data="${subMenu.sort}" th:if="${subMenu.pMenuId} == ${topMenu.menuId}">
                            <a th:href="${subMenu.url}" th:text="#{|menu.${subMenu.menuId}|}" onclick="showProgressBar()"></a>
                        </li>
                    </ul>
                </li>
            </ul>
            <div class="alice-navbar-profile">
                <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" onclick="profile_menu();">
                    Hello, <span sec:authentication="details.userName"></span>
                    <img th:src="@{/assets/media/image/profile_sample.jpg}" alt="profile pic" />
                    <span class="caret"></span>
                </button>
                <div id="profile-menu">
                    <ul>
                        <li><a href="javascript:logout()" th:text="#{common.btn.logout}">로그아웃1</a></li>
                        <li><a th:href="@{/users/{userKey}/userEditSelf(userKey=${#authentication.details.userKey})}" th:text="#{menu.editMyInfo}">내 정보 수정1</a></li>
                    </ul>
                </div>
            </div>
        </div><!-- collapse navbar-collapse -->
    </nav>
    <div>
        <form id="logoutForm" name="logoutForm" th:action="@{/logout}" method="post"></form>
    </div>
</body>
<script type="text/javascript" th:inline="javascript">
window.addEventListener('load', function() {
    hiddenProgressBar();
});

function logout() {
    document.getElementById('logoutForm').submit();
}

function profile_menu() {
    var profileMenu = document.getElementById('profile-menu');
    if (profileMenu.style.display != 'block') {
        profileMenu.style.display = 'block';
    } else {
        profileMenu.style.display = 'none';
    }
}
</script>
</html>