<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
</head>
<body>
<div class="token-info-tab">
    <h4 data-target-contents="token-history" th:text="#{token.label.history}"></h4>
    <h4 data-target-contents="token-related" th:text="#{token.label.relatedInstance}"></h4>
    <h4 data-target-contents="token-comment" th:text="#{common.label.comment}"></h4>
    <h4 data-target-contents="token-tag" th:text="#{common.label.tag}"></h4>
</div>
<div class="token-info-contents">
    <div class="token-history">
        <table class="table table-hover">
            <thead>
            <tr>
                <th width="45%" th:text="#{token.label.startDt}">시작일시</th>
                <th width="35%" th:text="#{token.label.elementName}">업무</th>
                <th width="20%" th:text="#{token.label.assignee}">담당자</th>
            </tr>
            </thead>
            <tbody id="history" class="list-wrap">
            <tr th:each="tokenHistory : ${instanceHistory}">
                <td width="45%" class="user-date-time" th:name="tokenDt"
                    th:text="${tokenHistory.tokenStartDt}"/>
                <td width="35%" th:text="${tokenHistory.elementName}"></td>
                <td width="20%" th:text="${tokenHistory.assigneeName}"></td>
            </tr>
            </tbody>
        </table>
    </div>
    <div class="token-related">
        <div class="list-item" th:each="rInstance: ${relatedInstance}">
            <div class="document-color" th:style="|background-color: ${rInstance.documentColor}|"></div>
            <div class="document-row">
                <div class="document-row-content">
                    <a th:onclick="openTokenEdit([[${rInstance.tokenId}]])">
                        <div class="document-title">
                            <h5 th:text="${rInstance.documentName}"></h5>
                            <h5 th:text="${rInstance.documentNo}"></h5>
                        </div>
                    </a>
                    <button type="button" class="trash-icon"
                            th:onclick="aliceDocument.deleteRelatedDoc({folderId: [[${rInstance.folderId}]], instanceId: [[${rInstance.instanceId}]]})"></button>
                </div>
                <div class="document-row-topic">
                    <!--                            <h4 th:each="topic: ${rInstance.topics}" th:text="${topic}"></h4>-->
                </div>
                <div class="document-row-info">
                    <div class="document-user">
                        <img class="profile-photo" th:src="@{${rInstance.avatarPath}}"/>
                        <h5 th:text="${rInstance.instanceCreateUserName}"></h5>
                    </div>
                    <span class="vertical-bar"></span>
                    <h5 class="dateFormatFromNow" th:text="${rInstance.instanceStartDt}"></h5>
                    <span class="vertical-bar"></span>
                    <h5 th:text="#{|common.code.token.status.${rInstance.instanceStatus}|}"></h5>
                </div>
            </div>
        </div>
        <div class="related-add list-item">
            <button th:onclick="openPopUp([[${tokenId}]])">
                <span class="icon-plus"></span>
            </button>
        </div>
    </div>
    <div id="commentList" class="token-comment">
        <div class="list-item" th:each="comment : ${commentList}">
            <div class="comment-row-info">
                <div class="comment-user">
                    <img class="profile-photo" th:src="@{${comment.avatarPath}}"/>
                    <h5 th:text="${comment.createUserName}"></h5>
                </div>
                <h5 class="user-date-time" th:text="${comment.createDt}"></h5>
                <div th:if="${#authentication.details.userKey} == ${comment.createUserKey}">
                    <button th:attr="onclick=|aliceDocument.deleteComment('${comment.commentId}')|"
                            class="trash-icon"></button>
                </div>
            </div>
            <div class="comment-row">
                <span th:text="${comment.content}"></span>
            </div>
        </div>
        <div id="comment-container" class="comment comment-input"></div>
    </div>
    <div class="token-tag">
        <div class="tag-input">
            <input name="tags" id="tags" th:value="|${tagList}|"/>
        </div>
    </div>
</div>
</body>
</html>
