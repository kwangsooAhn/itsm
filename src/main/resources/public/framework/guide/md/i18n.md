# 국제화 (다국어 처리 중심)
---
## 1. 개요
### 국제화(I18n)란?
**Internationalization**. i 와 n 사이에 18글자의 단어가 있어서 **I18n** 이라고도 표현한다.  
간략하게 제품이나 서비스를 특정지역의 언어나 문화에 맞추는, 즉 현지화라고 불리는 과정을 쉽게 할 수 있도록 계획하거나 이행하는 과정을 말한다.  

※ 국제화라는 주제는 너무 폭넓기 때문에, 본 문서에서는 **Spring boot**를 기준으로 한 다국어 처리를 중심으로 작성한다.  
  
  
## 2. 설정 방법  
### 1) Message Source  
Spring Boot의 특성 상 MessageSource 설정이 이미 되어있으며, resources 폴더 하위에 위치한 messages.yml 또는 messages.properties 파일을 default MessageSource로 사용한다.  
이 파일에 다국어 대상의 메시지들을 등록하여 사용하며, 이하 내용은 .yml을 기준으로 작성되었다.  
> **[Message Source 세부설정]**  
> · messages.yml (또는 messages.properties) 하나만 작성한 경우 모든 locale에 대해 해당 파일을 default로 사용한다.  
> · 특정 locale의 언어는 messages_XX.yml(또는 messages_XX.roperties) 형태로 파일을 추가함으로써 해당 언어를 지원할 수 있다. (ex. 한국어 지원 시, messages_ko.yml(또는 messages_ko.properties) 파일 추가)  
> · 단, messages 파일을 포함한 resource 경로에 **.**이 들어가면 path 구분자로 인식하므로, 정상적인 경로로 로딩되지 않으니 주의한다.
> · Message Source는  별도로 저장된 경로를 지정할 수 있다. message.yml을 사용 할 경우, YamlResourceBundle을 사용하여 아래와 같이 지정할 수 있다.  
>> **<I18nnConfig.kt>**  
>> ```java
>> ...
>> public open fun messageSource() : MessageSource {
>>     var ms: YamlMessageSource = YamlMessageSource()
>>     // .yml을 읽어올 basename 지정
>>     ms.setBasename("public/template/message/yml/messages")
>>     ms.setDefaultEncoding("UTF-8")
>>     ms.setAlwaysUseMessageFormat(true)
>>     ms.setUseCodeAsDefaultMessage(true)
>>     ms.setFallbackToSystemLocale(true)
>>     return ms;
>> }
>> ...
>> class YamlMessageSource : ResourceBundleMessageSource() {
>>     @Throws(MissingResourceException::class)`
>>     protected override fun doGetBundle(basename: String, locale: Locale) : ResourceBundle {
>>         return ResourceBundle.getBundle(basename, locale, YamlResourceBundle.Control.INSTANCE)
>>     }
>> }
>> ...
>> ```
>   
> cf) message.properties를 사용할 경우, application.properties에서 아래와 같이 지정할 수 있다..
>> **<application.properties>**  
>> ```
>> spring.messages.basename=public/template/message/messages
>> ```  
  
> **[Message Source 작성 예시]**  
>> **<message.yml>**  
>> ```properties
>>   ...
>>   # .properties와 동일하게 key=value 형식으로 작성
>>   login.welcome-msg=Welcome!
>>   
>>   # .yml의 경우 아래와 같이 계층적 구조로도 작성이 가능
>>   lang:
>>     change: "Change the language"
>>     en: "English"
>>     ko: "Korean"
>>     select: "-select-"
>>   ...
>> ```  
>>  
>> **<message.properties>**  
>> ```properties
>>   ...
>>   # key=value 형식으로 작성
>>   login.welcome-msg=Welcome!
>>   ...
>> ```  
  
### 2) Thymeleaf  
Thymeleaf 템플릿을 활용하여 다국어 처리를 지원한다. 관련 설정은 application.properties에 아래의 코드를 참고
> **<application.properties>**  
> ```
> spring.thymeleaf.suffix=.html
> spring.thymeleaf.mode=HTML
> spring.thymeleaf.cache=false
> spring.thymeleaf.prefix=classpath:/public/template/
> spring.thymeleaf.enabled=true
> spring.thymeleaf.encoding=UTF-8
> ```
  
### 3) 다국어 message 적용/작성
thymeleaf 적용 시, 아래의 샘플코드와 같이 th:text=#{key}의 형식으로 작성한다.
> **<sample.html>** 
> ```html
> <!DOCTYPE HTML>
> <html xmlns:th="http://www.thymeleaf.org">
> <head>
> <meta charset="UTF-8">
> <body>
>   ...
>   <div>
>     <span th:text="#{login.welcome-msg}">Some Text</span>
>   </div>
>   ...
>   <!-- n개 이상의 파라미터를 적용할 경우, 메시지에 추가할 파라미터는 소괄호 안에 작성한다. -->
>   ...
>   <h4 th:text="#{test.msg1(#{test.first})}"></h4>
>   <h4 th:text="#{test.msg2(#{test.one}, #{test.first})}"></h4>
> </body>
> </html>
> ```
   
   
## 3. [적용예제](http://localhost:8080/sample/sampleI18n) 🔗
   
   
## 4. 참고 사이트  
 [YAML이란?](http://anitoy.pe.kr/yaml-format/)  
 
 [YAML 간략 정리](https://m.blog.naver.com/PostView.nhn?blogId=wideeyed&logNo=221090209367&proxyReferer=https%3A%2F%2Fwww.google.com%2F)  
 
 [Spring boot 설정 파일 yaml 사용법 ](https://jeong-pro.tistory.com/159)  
 
 [YamlResourceBundle](https://github.com/akihyro/yaml-resource-bundle/blob/master/README.md)  
 
 [Spring Boot(Spring) i18n 설정 시 주의사항](https://blog.hkwon.me/spring-boot-spring-i18n-configuration/)  